<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="æ‰‹æ–æ—¥æ›†">
<title>æ‰‹æ–æˆç™®æ‚£è€… ğŸ¥¤ 2026</title>
<script src="https://cdn.tailwindcss.com"></script>

<style>
@import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700&display=swap');

:root {
  --bg:#f4f1ea; --pri:#9a8c98; --acc:#4a4e69;
}

* { -webkit-touch-callout:none; }

body{
  font-family:'Noto Sans TC',sans-serif;
  background:var(--bg);
  color:#22223b;
  margin:0;
  padding:env(safe-area-inset-top) 16px 20px;
  overflow-x:hidden;
}

.card{
  background:#fff;
  border-radius:16px;
  padding:16px;
  box-shadow:0 4px 16px rgba(0,0,0,.05);
}

.calendar-grid{
  display:grid;
  grid-template-columns:repeat(7,1fr);
  gap:6px;
}

.weekday{font-size:11px;text-align:center;color:var(--pri);}

.day{
  background:#fff;
  border-radius:12px;
  height:72px;
  padding:4px;
  border:1px solid #eee;
  position:relative;
}

.day.today{outline:2px solid var(--acc);}

.day-num{font-size:11px;color:var(--acc);opacity:.6;}

.cups{display:flex;justify-content:center;flex-wrap:wrap;font-size:18px;}

button{cursor:pointer;}
</style>
</head>

<body>
<div class="max-w-md mx-auto space-y-4">

<header class="flex justify-between items-center">
  <div>
    <h1 class="text-xl font-bold">æ‰‹æ–æ—¥æ›† ğŸ¥¤</h1>
    <p class="text-[10px] text-gray-400">2026 Addict Calendar</p>
  </div>
  <div class="text-right">
    <div id="yearCups" class="text-2xl font-black">0</div>
    <div class="text-[10px] text-gray-400">å…¨å¹´æ¯æ•¸</div>
  </div>
</header>

<div class="card flex justify-between text-sm">
  <div>
    <div class="text-gray-400 text-[10px]">æœ¬æœˆæ¯æ•¸</div>
    <div id="monthCups" class="font-bold">0</div>
  </div>
  <div>
    <div class="text-gray-400 text-[10px]">æœ¬æœˆèŠ±è²»</div>
    <div id="monthCost" class="font-bold">$0</div>
  </div>
</div>

<div id="monthTitle" class="font-bold text-lg"></div>
<div class="calendar-grid" id="calendar"></div>

<div class="card text-sm space-y-1">
  <div id="statMax"></div>
  <div id="statShop"></div>
</div>

<div class="flex gap-2">
  <button onclick="exportData()" class="flex-1 card text-center">å‚™ä»½</button>
  <button onclick="importData()" class="flex-1 card text-center">é‚„åŸ</button>
</div>

</div>

<script>
const KEY='DRINK_2026_MOBILE';
const year=2026;
const today=new Date();
let m=today.getMonth();
let data=JSON.parse(localStorage.getItem(KEY))||{};

function vibrate(){navigator.vibrate?.(10);}

function daysInMonth(y,m){return new Date(y,m+1,0).getDate();}
function firstDay(y,m){return new Date(y,m,1).getDay();}

function render(){
document.getElementById('monthTitle').textContent=`${year}å¹´ ${m+1}æœˆ`;
const cal=document.getElementById('calendar');
cal.innerHTML='';
['æ—¥','ä¸€','äºŒ','ä¸‰','å››','äº”','å…­'].forEach(d=>{
  cal.innerHTML+=`<div class="weekday">${d}</div>`;
});
for(let i=0;i<firstDay(year,m);i++)cal.innerHTML+='<div></div>';

let mc=0, mcost=0, yc=0;
let maxDay=0,maxCost=0;
let shopCount={};

for(let d=1;d<=daysInMonth(year,m);d++){
  const arr=(data[m]?.[d])||[];
  let cups=arr.filter(x=>x.price).length;
  let cost=arr.reduce((s,x)=>s+(+x.price||0),0);
  mc+=cups; mcost+=cost;
  yc+=cups;
  if(cost>maxCost){maxCost=cost;maxDay=d;}
  arr.forEach(x=>{
    if(x.shop)shopCount[x.shop]=(shopCount[x.shop]||0)+1;
  });

  cal.innerHTML+=`
  <div class="day ${today.getMonth()==m&&today.getDate()==d?'today':''}"
    onclick="edit(${d})">
    <div class="day-num">${d}</div>
    <div class="cups">${'ğŸ¥¤'.repeat(cups)}</div>
  </div>`;
}

document.getElementById('monthCups').textContent=mc;
document.getElementById('monthCost').textContent='$'+mcost;
document.getElementById('yearCups').textContent=yc;

let fav=Object.entries(shopCount).sort((a,b)=>b[1]-a[1])[0];
document.getElementById('statMax').textContent=
  maxDay?`ğŸ’¸ æœ€è²´ï¼š${m+1}/${maxDay} $${maxCost}`:'';
document.getElementById('statShop').textContent=
  fav?`ğŸ† æœ€å¸¸å–ï¼š${fav[0]} (${fav[1]}æ¯)`:'';
}

function edit(d){
vibrate();
let p=prompt('å¿«é€Ÿè¨˜éŒ„ï¼šè¼¸å…¥ åƒ¹æ ¼ï¼ˆç©ºç™½åˆªé™¤ï¼‰');
if(!data[m])data[m]={};
if(!data[m][d])data[m][d]=[];
if(p)data[m][d].push({price:p});
else data[m][d]=[];
save();
}

function save(){localStorage.setItem(KEY,JSON.stringify(data));render();}

function exportData(){
const blob=new Blob([JSON.stringify(data)],{type:'application/json'});
const a=document.createElement('a');
a.href=URL.createObjectURL(blob);
a.download='drink_backup.json';
a.click();
}

function importData(){
const i=document.createElement('input');
i.type='file';
i.onchange=e=>{
const r=new FileReader();
r.onload=()=>{data=JSON.parse(r.result);save();}
r.readAsText(e.target.files[0]);
};
i.click();
}

render();
</script>
</body>
</html>